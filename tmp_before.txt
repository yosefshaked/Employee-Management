import { createClient } from '@supabase/supabase-js';

let supabase = null;

export async function initializeSupabase() {
  if (supabase) return supabase; // אם כבר אותחל, החזר את הקיים

  if (window.electronAPI) {
    const config = await window.electronAPI.getSupabaseConfig();
    if (config && config.supabaseUrl && config.supabaseKey) {
      supabase = createClient(config.supabaseUrl, config.supabaseKey);
      return supabase;
    }
  }
  
  // אם לא הצלחנו, זרוק שגיאה
  throw new Error("Supabase config not found or invalid!");
}

// ייצא משתנה ריק. הקוד שלנו ישתמש בפונקציה במקום
export { supabase };